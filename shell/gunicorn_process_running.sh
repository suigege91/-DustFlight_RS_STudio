#!/bin/bash

function start_application() {
    flask_service_running
    echo "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||"
    echo "[CONSOLE] Running Function => [flask_service_running] Complete !"
    echo "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||"
    gunicorn_process_running
    echo "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||"
    echo "[CONSOLE] Running Function => [gunicorn_process_running] Complete !"
    echo "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||"
}

function flask_service_running() {
      python nohup ../manager.py server > nohup_output.log 2>&1 &
      echo "===================================================================================="
      echo "[NOTICE] Running Python Service Now ......"
      echo "===================================================================================="
}

function gunicorn_process_running() {
      gunicorn -w 4 -b 127.0.0.1:9001 wsgi:app
      echo "===================================================================================="
      echo "[NOTICE] Running Gunicorn Service Now ......"
      echo "===================================================================================="
}

function main() {
    echo "===================================================================================="
    echo "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||"
    echo "------------------------------------------------------------------------------------"
    start_application
    echo "------------------------------------------------------------------------------------"
    echo "||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||"
    echo "===================================================================================="
}

main
